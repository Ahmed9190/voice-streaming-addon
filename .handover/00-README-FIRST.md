# üì¢ Home Assistant WebRTC Voice Streaming

## What Is This?

This is a **real-time voice streaming solution** for Home Assistant that enables:

1. **üé§ Voice Sending** - Capture audio from your browser microphone and stream it to the server
2. **üéß Voice Receiving** - Listen to live audio streams from other clients in real-time
3. **üîÑ Relay Architecture** - One sender can broadcast to multiple receivers simultaneously

**Key Value Proposition**: Sub-50ms latency voice communication within your Home Assistant dashboard.

---

## Why Does This Exist?

Home Assistant's native voice assistants (Assist/Wyoming) focus on command-response patterns. This project enables:

- **Intercom functionality** between rooms/devices
- **Real-time audio monitoring** for baby monitors, security, etc.
- **Push-to-talk** communication within your smart home
- **Audio streaming** to/from custom automations

---

## Tech Stack At A Glance

| Layer               | Technology                  | Purpose                              |
| ------------------- | --------------------------- | ------------------------------------ |
| **Frontend**        | JavaScript (Web Components) | Custom HA dashboard cards            |
| **Signaling**       | WebSocket + JSON            | Control messages, stream negotiation |
| **Audio Transport** | WebRTC (aiortc)             | Low-latency peer-to-peer audio       |
| **Backend**         | Python (aiohttp)            | Relay server, stream management      |
| **Infrastructure**  | Docker Compose, Nginx       | Containerization, SSL/HTTPS          |
| **Home Automation** | Home Assistant              | Core platform, panel hosting         |

---

## Quick Start (30 Seconds)

```bash
# Clone and enter directory
git clone <repo-url>
cd webrtc_voice_sending

# Start everything
./start_services.sh

# Open browser
open https://localhost
```

Accept the self-signed certificate warning, complete HA setup if needed, then look for **Voice Send** and **Voice Receive** panels in the sidebar.

---

## Repository Map

```
webrtc_voice_sending/
‚îú‚îÄ‚îÄ üê≥ docker-compose.yml      # Orchestrates all services
‚îú‚îÄ‚îÄ üöÄ start_services.sh       # One-command startup
‚îú‚îÄ‚îÄ üõë stop_services.sh        # Graceful shutdown
‚îú‚îÄ‚îÄ üîí ssl/                    # Self-signed certificates
‚îú‚îÄ‚îÄ üåê nginx.conf              # HTTPS proxy configuration
‚îÇ
‚îú‚îÄ‚îÄ üéõÔ∏è config/                 # Home Assistant config
‚îÇ   ‚îú‚îÄ‚îÄ configuration.yaml     # HA main config
‚îÇ   ‚îú‚îÄ‚îÄ www/                   # Frontend JS cards
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ voice-sending-card.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ voice-receiving-card.js
‚îÇ   ‚îî‚îÄ‚îÄ custom_components/     # HA integration
‚îÇ       ‚îî‚îÄ‚îÄ voice_streaming/
‚îÇ
‚îú‚îÄ‚îÄ üêç webrtc_backend/         # Python WebRTC server
‚îÇ   ‚îú‚îÄ‚îÄ webrtc_server_relay.py # Production relay server
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # Container definition
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt       # Python dependencies
‚îÇ
‚îî‚îÄ‚îÄ üìÑ .handover/              # This documentation
```

---

## First Steps After Cloning

1. **Read**: [01-SETUP-GUIDE.md](./01-SETUP-GUIDE.md) for zero-to-running instructions
2. **Understand**: [02-ARCHITECTURE.md](./02-ARCHITECTURE.md) for system design
3. **‚ö†Ô∏è Know the traps**: [04-GOTCHAS.md](./04-GOTCHAS.md) before modifying code
4. **Verify**: Run `python integration_test.py` after setup

---

## Key Contacts / Ownership

> ‚ö†Ô∏è **Single Owner Alert**: This codebase appears to have a single primary contributor. Ensure you document your changes thoroughly.

---

## Status

| Feature                     | Status              |
| --------------------------- | ------------------- |
| Voice Sending               | ‚úÖ Working          |
| Voice Receiving             | ‚úÖ Working          |
| Multi-receiver Broadcast    | ‚úÖ Working          |
| TURN Server (NAT traversal) | ‚ö†Ô∏è Not configured   |
| Production SSL Certs        | ‚ö†Ô∏è Self-signed only |
| HA Assist Integration       | ‚ùå Not implemented  |

---

_Generated by Elite Staff Engineer Handover Protocol (ESEHP-ASKS v2.0)_
_Last Updated: 2026-01-11_
